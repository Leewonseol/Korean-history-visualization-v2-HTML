<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ì‚¬ ì‹œê°í™” - íƒ€ì„ë¼ì¸ & ì‹œê³„ì—´ íë¦„ë„</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;700;900&family=Pretendard:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0a0f;
            --bg-card: #12121a;
            --bg-hover: #1a1a28;
            --accent-gold: #d4a574;
            --accent-jade: #7eb8a2;
            --accent-crimson: #c9534a;
            --accent-indigo: #6b7fd4;
            --accent-purple: #9a7fd4;
            --accent-teal: #5fb4a2;
            --text-primary: #e8e6e3;
            --text-secondary: #9a9590;
            --border: #2a2a3a;
            --shadow: rgba(0, 0, 0, 0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Pretendard', -apple-system, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        header {
            background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-dark) 100%);
            border-bottom: 1px solid var(--border);
            padding: 2rem 3rem;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        header h1 {
            font-family: 'Noto Serif KR', serif;
            font-weight: 900;
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-jade));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header p { color: var(--text-secondary); margin-top: 0.5rem; font-weight: 300; }

        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            padding: 1rem 3rem;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 0.8rem 1.5rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-family: 'Pretendard', sans-serif;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-tab:hover { background: var(--bg-hover); color: var(--text-primary); }
        .nav-tab.active { background: linear-gradient(135deg, var(--accent-gold), var(--accent-jade)); color: var(--bg-dark); }

        .main-container { display: flex; min-height: calc(100vh - 150px); }
        .view-container { display: none; width: 100%; }
        .view-container.active { display: flex; flex-direction: column; }

        /* Timeline Section */
        .timeline-section { flex: 1; padding: 2rem; overflow-y: auto; max-height: calc(100vh - 150px); }
        .timeline-container { position: relative; padding-left: 3rem; }
        .timeline-container::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, var(--accent-gold), var(--accent-jade), var(--accent-indigo));
            border-radius: 3px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 1.5rem;
            animation: fadeInUp 0.5s ease forwards;
            opacity: 0;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -3rem;
            top: 1.2rem;
            width: 12px;
            height: 12px;
            background: var(--accent-gold);
            border-radius: 50%;
            border: 3px solid var(--bg-dark);
            z-index: 1;
        }

        .timeline-item:nth-child(3n+2)::before { background: var(--accent-jade); }
        .timeline-item:nth-child(3n)::before { background: var(--accent-indigo); }

        .event-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .event-card:hover {
            border-color: var(--accent-gold);
            box-shadow: 0 8px 32px var(--shadow);
            transform: translateX(5px);
        }

        .event-header {
            padding: 1.2rem 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .event-time {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--accent-gold);
            background: rgba(212, 165, 116, 0.1);
            padding: 0.3rem 0.7rem;
            border-radius: 20px;
            white-space: nowrap;
        }

        .event-title { font-family: 'Noto Serif KR', serif; font-size: 1.1rem; font-weight: 700; flex: 1; line-height: 1.4; }
        .toggle-icon { font-size: 1.2rem; color: var(--text-secondary); transition: transform 0.3s ease; }
        .event-card.open .toggle-icon { transform: rotate(180deg); }

        .event-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease; }
        .event-card.open .event-content { max-height: 600px; }
        .content-inner { padding: 0 1.5rem 1.5rem; border-top: 1px solid var(--border); }

        .person-section { margin-top: 1rem; }
        .person-label { font-size: 0.75rem; font-weight: 600; color: var(--accent-jade); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.5rem; }

        .person-item { background: var(--bg-hover); border-radius: 8px; margin-bottom: 0.5rem; overflow: hidden; }
        .person-header { padding: 0.8rem 1rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: background 0.2s ease; }
        .person-header:hover { background: rgba(126, 184, 162, 0.1); }
        .person-name { font-weight: 500; display: flex; align-items: center; gap: 0.5rem; }
        .person-name::before { content: 'ğŸ‘¤'; font-size: 0.9rem; }
        .person-toggle { font-size: 0.8rem; color: var(--text-secondary); transition: transform 0.3s ease; }
        .person-item.open .person-toggle { transform: rotate(90deg); }

        .expression-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; }
        .person-item.open .expression-content { max-height: 300px; }
        .expression-inner { padding: 0.8rem 1rem; border-top: 1px solid var(--border); background: rgba(107, 127, 212, 0.05); }
        .expression-label { font-size: 0.7rem; font-weight: 600; color: var(--accent-indigo); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.3rem; }
        .expression-text { font-size: 0.9rem; line-height: 1.6; color: var(--text-secondary); }

        /* Temporal Flow Section - NEW */
        .flow-section {
            width: 100%;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .flow-header { margin-bottom: 1.5rem; }
        .flow-header h2 { font-family: 'Noto Serif KR', serif; font-size: 1.5rem; margin-bottom: 0.5rem; }
        .flow-header p { color: var(--text-secondary); font-size: 0.9rem; }

        .flow-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .flow-controls label {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .flow-controls select, .flow-controls input {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-family: 'Pretendard', sans-serif;
            font-size: 0.85rem;
        }

        .flow-controls select:focus, .flow-controls input:focus {
            outline: none;
            border-color: var(--accent-jade);
        }

        #flow-graph-container {
            flex: 1;
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            overflow: auto;
            min-height: 700px;
            position: relative;
        }

        #flow-graph {
            min-width: 2000px;
            min-height: 100%;
        }

        /* Flow Graph Styles */
        .time-axis-line { stroke: var(--border); stroke-width: 2; }
        .time-tick { stroke: var(--border); stroke-width: 1; }
        .time-label { fill: var(--text-secondary); font-size: 10px; font-family: 'Pretendard', sans-serif; }
        .era-label { fill: var(--accent-gold); font-size: 11px; font-weight: 600; font-family: 'Noto Serif KR', serif; }

        .person-lane { fill: none; stroke: var(--border); stroke-width: 1; stroke-dasharray: 4,4; opacity: 0.3; }
        .person-lane-label { fill: var(--text-secondary); font-size: 11px; font-family: 'Pretendard', sans-serif; font-weight: 500; }

        .role-node {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .role-node:hover { filter: brightness(1.2); }
        .role-node rect { rx: 6; ry: 6; stroke-width: 2; }
        .role-node text { font-family: 'Pretendard', sans-serif; font-size: 9px; fill: var(--text-primary); pointer-events: none; }

        .flow-link {
            fill: none;
            stroke-width: 2;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }

        .flow-link:hover { opacity: 1; stroke-width: 3; }

        .flow-arrow { fill: var(--text-secondary); }

        /* Role Category Colors */
        .role-king { fill: var(--accent-gold); stroke: #b8925f; }
        .role-minister { fill: var(--accent-jade); stroke: #5a9a86; }
        .role-rebel { fill: var(--accent-crimson); stroke: #a8423a; }
        .role-military { fill: var(--accent-indigo); stroke: #5568b8; }
        .role-scholar { fill: var(--accent-purple); stroke: #7a64b8; }
        .role-foreign { fill: #6b8fd4; stroke: #5578b8; }
        .role-people { fill: var(--accent-teal); stroke: #4a9486; }
        .role-default { fill: #5a5a6a; stroke: #4a4a5a; }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem 1.2rem;
            font-size: 0.85rem;
            pointer-events: none;
            z-index: 1000;
            max-width: 350px;
            box-shadow: 0 12px 40px var(--shadow);
        }

        .tooltip-title { font-weight: 700; margin-bottom: 0.5rem; font-size: 1rem; color: var(--accent-gold); }
        .tooltip-time { font-size: 0.75rem; color: var(--accent-jade); margin-bottom: 0.5rem; }
        .tooltip-role { font-size: 0.8rem; color: var(--accent-indigo); margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
        .tooltip-role-badge { width: 10px; height: 10px; border-radius: 50%; }
        .tooltip-expression { color: var(--text-secondary); font-size: 0.85rem; line-height: 1.5; border-top: 1px solid var(--border); padding-top: 0.5rem; margin-top: 0.5rem; }
        .tooltip-transition { margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid var(--border); font-size: 0.8rem; color: var(--accent-purple); }

        /* Legend */
        .flow-legend {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            margin-top: 1rem;
            padding: 1rem;
            background: var(--bg-hover);
            border-radius: 8px;
        }

        .legend-item { display: flex; align-items: center; gap: 0.5rem; font-size: 0.8rem; color: var(--text-secondary); }
        .legend-color { width: 14px; height: 14px; border-radius: 4px; }

        /* Cluster Section */
        .cluster-section { width: 100%; padding: 2rem; overflow-y: auto; }
        .cluster-header { margin-bottom: 2rem; }
        .cluster-header h2 { font-family: 'Noto Serif KR', serif; font-size: 1.5rem; margin-bottom: 0.5rem; }

        #cluster-chart {
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .cluster-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .cluster-title { font-family: 'Noto Serif KR', serif; font-size: 1.2rem; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }
        .cluster-badge { width: 12px; height: 12px; border-radius: 50%; }
        .cluster-period { font-size: 0.85rem; color: var(--accent-gold); margin-bottom: 0.5rem; }
        .cluster-keywords { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem; }
        .keyword-tag { font-size: 0.75rem; padding: 0.3rem 0.6rem; border-radius: 20px; background: var(--bg-hover); color: var(--text-secondary); }
        .cluster-events { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }

        @media (max-width: 768px) {
            header { padding: 1.5rem; }
            header h1 { font-size: 1.6rem; }
            .nav-tabs { padding: 1rem; overflow-x: auto; }
            .timeline-section, .flow-section, .cluster-section { padding: 1rem; }
            .timeline-container { padding-left: 2rem; }
            .timeline-item::before { left: -2rem; }
        }
    </style>
</head>
<body>
    <header>
        <h1>éŸ“åœ‹å² æ™‚é–“ì˜ íë¦„</h1>
        <p>êµ¬ì„ê¸° ì‹œëŒ€ë¶€í„° í˜„ëŒ€ê¹Œì§€, í•œêµ­ì‚¬ì˜ ì£¼ìš” ì‚¬ê±´ê³¼ ì¸ë¬¼ì˜ ì—­í•  ë³€í™”ë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤</p>
    </header>

    <nav class="nav-tabs">
        <button class="nav-tab active" data-view="timeline">ğŸ“œ íƒ€ì„ë¼ì¸</button>
        <button class="nav-tab" data-view="flow">ğŸ”„ ì‹œê³„ì—´ íë¦„ë„</button>
        <button class="nav-tab" data-view="cluster">ğŸ“Š ì‹œëŒ€ë³„ êµ°ì§‘ë¶„ì„</button>
    </nav>

    <main class="main-container">
        <!-- Timeline View -->
        <div class="view-container active" id="timeline-view">
            <section class="timeline-section">
                <div class="timeline-container" id="timeline-container"></div>
            </section>
        </div>

        <!-- Temporal Flow View - NEW -->
        <div class="view-container" id="flow-view">
            <section class="flow-section">
                <div class="flow-header">
                    <h2>ì‹œê³„ì—´ íë¦„í˜• êµ¬ì¡°ë°©ì •ì‹ ëª¨í‹°í”„</h2>
                    <p>ì¸ë¬¼/ì§‘ë‹¨ì´ ì‹œê°„ì— ë”°ë¼ ì–´ë–¤ ê°œë…/í–‰ë™/ì—­í• ë¡œ ë³€í˜•ë˜ëŠ”ì§€ë¥¼ ì‹œê°í™”í•©ë‹ˆë‹¤. ë…¸ë“œë¥¼ í´ë¦­í•˜ë©´ ìƒì„¸ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div class="flow-controls">
                    <label>ì‹œëŒ€ í•„í„°:</label>
                    <select id="era-filter">
                        <option value="all">ì „ì²´ ì‹œëŒ€</option>
                        <option value="ancient">ê³ ëŒ€ (ì„ ì‚¬~ì‚¼êµ­)</option>
                        <option value="unified">í†µì¼ì‹ ë¼/ë°œí•´</option>
                        <option value="goryeo">ê³ ë ¤ ì‹œëŒ€</option>
                        <option value="joseon-early">ì¡°ì„  ì „ê¸°</option>
                        <option value="joseon-late">ì¡°ì„  í›„ê¸°</option>
                        <option value="modern">ê·¼í˜„ëŒ€</option>
                    </select>
                    <label>ì—­í•  í•„í„°:</label>
                    <select id="role-filter">
                        <option value="all">ì „ì²´ ì—­í• </option>
                        <option value="king">ì™•/êµ°ì£¼</option>
                        <option value="minister">ì‹ í•˜/ê´€ë£Œ</option>
                        <option value="military">ë¬´ì¥/ì¥êµ°</option>
                        <option value="rebel">ë°˜ë€/ì €í•­</option>
                        <option value="scholar">í•™ì/ì‹¤í•™</option>
                        <option value="people">ë¯¼ì¤‘/ì§‘ë‹¨</option>
                    </select>
                    <label>ì¸ë¬¼ ê²€ìƒ‰:</label>
                    <input type="text" id="person-search" placeholder="ì¸ë¬¼ëª… ì…ë ¥...">
                </div>
                <div id="flow-graph-container">
                    <svg id="flow-graph"></svg>
                </div>
                <div class="flow-legend">
                    <div class="legend-item"><div class="legend-color" style="background: var(--accent-gold);"></div> ì™•/êµ°ì£¼</div>
                    <div class="legend-item"><div class="legend-color" style="background: var(--accent-jade);"></div> ì‹ í•˜/ê´€ë£Œ</div>
                    <div class="legend-item"><div class="legend-color" style="background: var(--accent-indigo);"></div> ë¬´ì¥/ì¥êµ°</div>
                    <div class="legend-item"><div class="legend-color" style="background: var(--accent-crimson);"></div> ë°˜ë€/ì €í•­</div>
                    <div class="legend-item"><div class="legend-color" style="background: var(--accent-purple);"></div> í•™ì/ì‹¤í•™</div>
                    <div class="legend-item"><div class="legend-color" style="background: var(--accent-teal);"></div> ë¯¼ì¤‘/ì§‘ë‹¨</div>
                    <div class="legend-item"><div class="legend-color" style="background: #6b8fd4;"></div> ì™¸ì„¸/ì™¸êµ­</div>
                </div>
            </section>
        </div>

        <!-- Cluster View -->
        <div class="view-container" id="cluster-view">
            <section class="cluster-section">
                <div class="cluster-header">
                    <h2>ì‹œê³„ì—´ êµ°ì§‘ë¶„ì„ ê²°ê³¼</h2>
                    <p>í…ìŠ¤íŠ¸ ë§ˆì´ë‹ê³¼ í† í°í™”ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œêµ­ì‚¬ì˜ ê±°ì‹œì  íë¦„ì„ ì‹œëŒ€ë³„ë¡œ ë¶„ì„í•©ë‹ˆë‹¤.</p>
                </div>
                <div id="cluster-chart"></div>
                <div id="cluster-details"></div>
            </section>
        </div>
    </main>

    <div class="tooltip" id="tooltip" style="display: none;"></div>

    <script>
        // Historical Data with enhanced structure
        const historyData = [
            { idx: 0, time: "êµ¬ì„ê¸° ì‹œëŒ€", event: "êµ¬ì„ê¸° ì‹œëŒ€ì˜ ìƒí™œ", person: "êµ¬ì„ê¸°ì¸", expression: "ì£¼ë¨¹ë„ë¼ ë“± ë—€ì„ê¸°ë¥¼ ì²˜ìŒ ì œì‘í•˜ì—¬ ì‚¬ëƒ¥ê³¼ ì±„ì§‘ì„ í•¨, ì£¼ë¡œ ë™êµ´ì´ë‚˜ ê°•ê°€ì˜ ë§‰ì§‘ì— ê±°ì£¼í•¨", era: "ancient", order: 1 },
            { idx: 1, time: "ì‹ ì„ê¸° ì‹œëŒ€", event: "ì‹ ì„ê¸° ì‹œëŒ€ì˜ ìƒí™œ ë° ë†ê²½ì˜ ì‹œì‘", person: "ì‹ ì„ê¸°ì¸", expression: "ê°€ë½ë°”í€´ë¡œ ì‹¤ì„ ë½‘ìŒ, ë†ê²½ê³¼ ì •ì°© ìƒí™œ(ì‹ ì„ê¸° í˜ëª…) ì‹œì‘, ë¹—ì‚´ë¬´ëŠ¬ í† ê¸°ì— ì‹ëŸ‰ ì €ì¥", era: "ancient", order: 2 },
            { idx: 2, time: "ì²­ë™ê¸° ì‹œëŒ€", event: "ì²­ë™ê¸° ì‹œëŒ€ì˜ ìƒí™œ ë° ê³„ê¸‰ ì‚¬íšŒì˜ ì¶œí˜„", person: "ì§€ë°°ì¸µ(êµ°ì¥)", expression: "ê³ ì¸ëŒ ì¶•ì¡°, ë¹„íŒŒí˜• ë™ê²€ ì‚¬ìš©, ë°˜ë‹¬ ëŒì¹¼ë¡œ ë²¼ ìˆ˜í™•, ë¶€ì—¬ ì†¡êµ­ë¦¬ ìœ ì , ë¯¸ì†¡ë¦¬ì‹ í† ê¸°", era: "ancient", order: 3 },
            { idx: 3, time: "ê³ ì¡°ì„  (BC 2333ë…„)", event: "ê³ ì¡°ì„ ì˜ ê±´êµ­ê³¼ ë²”ê¸ˆ 8ì¡°", person: "ë‹¨êµ°ì™•ê²€", expression: "ì‚¬íšŒ ì§ˆì„œ ìœ ì§€ë¥¼ ìœ„í•´ ë²”ê¸ˆ 8ì¡°ë¥¼ ë§Œë“¦, í™ìµì¸ê°„ ì •ì‹  ê³„ìŠ¹", era: "ancient", order: 4 },
            { idx: 4, time: "ì´ˆê¸° ì² ê¸° ì‹œëŒ€", event: "ì—¬ëŸ¬ ë‚˜ë¼ì˜ ì„±ì¥ ë° ì² ê¸° ìœ ë¬¼", person: "ë§ˆê°€, ìš°ê°€, ì €ê°€, êµ¬ê°€, ì˜¥ì €(ìêµ°, ì‚¼ë¡œ)", expression: "ë¶€ì—¬ì˜ ì‚¬ì¶œë„ì™€ ì œì²œ í–‰ì‚¬ ì˜ê³ (12ì›”), ì˜¥ì €ì˜ ë¯¼ë©°ëŠë¦¬ì œì™€ ê³¨ì¥ì œ, ëª…ë„ì „ ì‚¬ìš© ë° ì¤‘ê³„ ë¬´ì—­", era: "ancient", order: 5 },
            { idx: 5, time: "ê³ ì¡°ì„  (ìœ„ë§Œì¡°ì„ )", event: "ìœ„ë§Œì˜ ì™•ìœ„ ì°¬íƒˆê³¼ ê³ ì¡°ì„ ì˜ ë°œì „", person: "ìœ„ë§Œ, ì¤€ì™•", expression: "ìœ„ë§Œì´ ì¤€ì™•ì˜ ì™•ìœ„ë¥¼ ì°¬íƒˆí•¨, ì¤€ì™•ì´ ë‚¨ìª½ìœ¼ë¡œ ë§ëª…í•¨, ì™• ì•„ë˜ ìƒÂ·ëŒ€ë¶€Â·ì¥êµ° ë“±ì˜ ê´€ì§ì„ ë‘ ", era: "ancient", order: 6 },
            { idx: 6, time: "BC 108ë…„", event: "ê³ ì¡°ì„ ì˜ ë©¸ë§ (í•œì˜ ì¹¨ì…)", person: "ìš°ê±°ì™•, í•œ ë¬´ì œ", expression: "ìš°ê±°ì™•ì´ ì™•ê²€ì„±ì—ì„œ í•œì˜ ì¹¨ëµì— ë§ì„œ ëê¹Œì§€ í•­ì „í•¨", era: "ancient", order: 7 },
            { idx: 7, time: "ê³ êµ¬ë ¤ ê³ êµ­ì²œì™•ê¸°", event: "ì§„ëŒ€ë²• ì‹¤ì‹œ", person: "ì„íŒŒì†Œ", expression: "ë¹ˆë¯¼ êµ¬ì œë¥¼ ìœ„í•´ ë´„ì— ê³¡ì‹ì„ ë¹Œë ¤ì£¼ê³  ê°€ì„ì— ê°šê²Œ í•˜ëŠ” ì¶˜ëŒ€ì¶”ë‚© ì‹¤ì‹œ", era: "ancient", order: 8 },
            { idx: 8, time: "ê³ ëŒ€ ê°€ì•¼ ì‹œê¸°", event: "ê°€ì•¼ ì—°ë§¹ì˜ ë°œì „", person: "ê¹€ìˆ˜ë¡œ, í—ˆí™©í›„", expression: "ì² ì˜ ìƒì‚°ê³¼ ìˆ˜ì¶œ(ë©ì´ì‡ ë¥¼ í™”íì²˜ëŸ¼ ì‚¬ìš©), êµ¬ì§€ê°€, ê¹€í•´ ëŒ€ì„±ë™ ê³ ë¶„êµ°", era: "ancient", order: 9 },
            { idx: 9, time: "4ì„¸ê¸°", event: "ë°±ì œ ê·¼ì´ˆê³ ì™•ì˜ ì „ì„±ê¸°", person: "ê·¼ì´ˆê³ ì™•, ê³ êµ­ì›ì™•", expression: "ë°±ì œê°€ í‰ì–‘ì„±ì„ ê³µê²©í•˜ì—¬ ê³ êµ¬ë ¤ ê³ êµ­ì›ì™•ì„ ì „ì‚¬ì‹œí‚´", era: "ancient", order: 10 },
            { idx: 10, time: "372ë…„", event: "ê³ êµ¬ë ¤ ì†Œìˆ˜ë¦¼ì™•ì˜ ì²´ì œ ì •ë¹„", person: "ì†Œìˆ˜ë¦¼ì™•", expression: "íƒœí•™ ì„¤ë¦½, ìœ¨ë ¹ ë°˜í¬, ë¶ˆêµ ìˆ˜ìš©ì„ í†µí•´ êµ­ê°€ ì²´ì œë¥¼ ì •ë¹„í•¨", era: "ancient", order: 11 },
            { idx: 11, time: "4ì„¸ê¸°~5ì„¸ê¸°", event: "ê³ êµ¬ë ¤ ê´‘ê°œí† íƒœì™•ì˜ ì˜í†  í™•ì¥", person: "ê´‘ê°œí† íƒœì™•, ë‚´ë¬¼ì™•", expression: "ì˜ë½ ì—°í˜¸ ì‚¬ìš©, ì‹ ë¼ì— ì¹¨ì…í•œ ì™œ ê²©í‡´(í˜¸ìš°ëª… ê·¸ë¦‡), ë‚´ë¬¼ì™• êµ¬ì›", era: "ancient", order: 12 },
            { idx: 12, time: "427ë…„", event: "ê³ êµ¬ë ¤ ì¥ìˆ˜ì™•ì˜ í‰ì–‘ ì²œë„", person: "ì¥ìˆ˜ì™•", expression: "í‰ì–‘ì„ ìƒˆë¡œìš´ ë„ììœ¼ë¡œ ì •í•˜ê³  ë‚¨ì§„ ì •ì±…ì„ ì¶”ì§„í•¨", era: "ancient", order: 13 },
            { idx: 13, time: "6ì„¸ê¸°", event: "ì‹ ë¼ ì§€ì¦ì™•ì˜ ìš°ì‚°êµ­ ë³µì†", person: "ì§€ì¦ì™•, ì´ì‚¬ë¶€", expression: "ì´ì‚¬ë¶€ê°€ ìš°ì‚°êµ­ì„ ë³µì†ì‹œì¼œ ì‹ ë¼ ì˜í† ë¡œ í¸ì…í•¨", era: "ancient", order: 14 },
            { idx: 14, time: "538ë…„", event: "ë°±ì œ ì„±ì™•ì˜ ì‚¬ë¹„ ì²œë„", person: "ì„±ì™•", expression: "ìˆ˜ë„ë¥¼ ì›…ì§„ì—ì„œ ì‚¬ë¹„ë¡œ ì˜®ê¹€, ì§„í¥ì™•ê³¼ í•œê°• ìœ ì—­ íšŒë³µ ì‹œë„", era: "ancient", order: 15 },
            { idx: 15, time: "612ë…„", event: "ì‚´ìˆ˜ëŒ€ì²©", person: "ì„ì§€ë¬¸ë•", expression: "ì‚´ìˆ˜(ì²­ì²œê°•)ì—ì„œ ìˆ˜ë‚˜ë¼ì˜ ëŒ€êµ°ì„ í¬ê²Œ ê²©í‡´í•¨", era: "ancient", order: 16 },
            { idx: 16, time: "660ë…„", event: "ë°±ì œì˜ ë©¸ë§", person: "ì˜ìì™•, ê³„ë°±, ê¹€ìœ ì‹ ", expression: "ê³„ë°±ì˜ ê²°ì‚¬ëŒ€ê°€ í™©ì‚°ë²Œì—ì„œ ì‹ ë¼êµ°ì— ë§ì„œ í•­ì „í•¨", era: "ancient", order: 17 },
            { idx: 17, time: "7ì„¸ê¸°", event: "ì²œë¦¬ì¥ì„± ì¶•ì¡° ë° ì—°ê°œì†Œë¬¸ì˜ ì •ë³€", person: "ì—°ê°œì†Œë¬¸, ë‹¹ë‚˜ë¼", expression: "ì—°ê°œì†Œë¬¸ì´ ì •ë³€ìœ¼ë¡œ ê¶Œë ¥ì„ ì¥ì•…í•¨, ë‹¹ì˜ ì¹¨ì…ì— ëŒ€ë¹„í•´ ì¥ì„±ì„ ìŒ“ìŒ", era: "ancient", order: 18 },
            { idx: 18, time: "676ë…„", event: "ê¸°ë²Œí¬ ì „íˆ¬ì™€ ì‚¼êµ­ í†µì¼ ì™„ìˆ˜", person: "ë¬¸ë¬´ì™•", expression: "ê¸°ë²Œí¬ì—ì„œ ë‹¹ì˜ ìˆ˜êµ°ì„ ë¬¼ë¦¬ì³ ë‚˜ë‹¹ ì „ìŸ ìŠ¹ë¦¬ ë° ì‚¼êµ­ í†µì¼ ì™„ìˆ˜", era: "unified", order: 19 },
            { idx: 19, time: "681ë…„~692ë…„", event: "ì‹ ë¼ ì‹ ë¬¸ì™•ì˜ ì™•ê¶Œ ê°•í™”", person: "ì‹ ë¬¸ì™•, ê¹€í ëŒ", expression: "ê¹€í ëŒì˜ ë‚œ ì§„ì••, ê´€ë£Œì „ ì§€ê¸‰ ë° ë…¹ì íì§€, êµ­í•™ ì„¤ì¹˜", era: "unified", order: 20 },
            { idx: 20, time: "698ë…„", event: "ë°œí•´ì˜ ê±´êµ­ê³¼ ë°œì „", person: "ëŒ€ì¡°ì˜, ë¬´ì™•, ë¬¸ì™•, ì„ ì™•", expression: "ë™ëª¨ì‚°ì—ì„œ ê±´êµ­, ì£¼ìê° ì„¤ì¹˜, ì—°í˜¸(ì¸ì•ˆ, ëŒ€í¥, ê±´í¥) ì‚¬ìš©, 5ê²½ 15ë¶€ 62ì£¼", era: "unified", order: 21 },
            { idx: 21, time: "9ì„¸ê¸°", event: "ì‹ ë¼ ë§ê¸°ì˜ í˜¼ë€ê³¼ í˜¸ì¡±ì˜ ì„±ì¥", person: "ê¹€í—Œì°½, ì–‘ê¸¸, ì›ì¢…, ì• ë…¸", expression: "ê¹€í—Œì°½ì˜ ë‚œ ë°œìƒ, ìŠ¤ìŠ¤ë¡œ ì„±ì£¼ ë˜ëŠ” ì¥êµ°ì´ë¼ ì¹­í•˜ëŠ” í˜¸ì¡±ì˜ ì„¸ë ¥ í™•ì¥", era: "unified", order: 22 },
            { idx: 22, time: "900ë…„", event: "í›„ë°±ì œ ê±´êµ­", person: "ê²¬í›¤", expression: "ì™„ì‚°ì£¼ë¥¼ ê·¼ê±°ì§€ë¡œ ì‚¼ìŒ, ì´í›„ ê¸ˆì‚°ì‚¬ì— ìœ íë¨", era: "unified", order: 23 },
            { idx: 23, time: "918ë…„~936ë…„", event: "ê³ ë ¤ ê±´êµ­ê³¼ í›„ì‚¼êµ­ í†µì¼", person: "íƒœì¡° ì™•ê±´", expression: "í›ˆìš” 10ì¡°ë¥¼ ë‚¨ê¹€, ë¯¼ìƒ ì•ˆì •ì„ ìœ„í•´ í‘ì°½ ì„¤ì¹˜", era: "goryeo", order: 24 },
            { idx: 24, time: "956ë…„~958ë…„", event: "ê³ ë ¤ ê´‘ì¢…ì˜ ê°œí˜ ì •ì¹˜", person: "ê´‘ì¢…, ìŒê¸°", expression: "ë…¸ë¹„ì•ˆê²€ë²• ì‹œí–‰, ìŒê¸°ì˜ ê±´ì˜ë¡œ ê³¼ê±°ì œ ì‹¤ì‹œ", era: "goryeo", order: 25 },
            { idx: 25, time: "10~11ì„¸ê¸°", event: "ê±°ë€ì˜ ì¹¨ì…ê³¼ ëŒ€ì²˜", person: "ì„œí¬, ê°•ê°ì°¬", expression: "ì„œí¬ì˜ ì™¸êµë¡œ ê°•ë™ 6ì£¼ í™•ë³´, ê°•ê°ì°¬ì˜ ê·€ì£¼ ëŒ€ì²© ëŒ€ìŠ¹, ì²œë¦¬ì¥ì„± ì¶•ì¡°", era: "goryeo", order: 26 },
            { idx: 26, time: "992ë…„ (ê³ ë ¤ ì„±ì¢…)", event: "ê³ ë ¤ ì„±ì¢…ì˜ ìœ êµ í†µì¹˜ ì²´ì œ ì •ë¹„", person: "ì„±ì¢…, ìµœìŠ¹ë¡œ", expression: "ìµœìŠ¹ë¡œì˜ ì‹œë¬´ 28ì¡° ìˆ˜ìš©, 12ëª© ì„¤ì¹˜ ë° ì§€ë°©ê´€ íŒŒê²¬", era: "goryeo", order: 27 },
            { idx: 27, time: "ê³ ë ¤ ìˆ™ì¢…~ì˜ˆì¢…", event: "ë³„ë¬´ë°˜ê³¼ ë™ë¶ êµ¬ì„±", person: "ìœ¤ê´€, ì—¬ì§„ì¡±", expression: "ì‹ ê¸°êµ°, ì‹ ë³´êµ°, í•­ë§ˆêµ°ìœ¼ë¡œ êµ¬ì„±ëœ ë³„ë¬´ë°˜ ì¡°ì§, ì—¬ì§„ ì •ë²Œ í›„ 9ì„± ì¶•ì¡°", era: "goryeo", order: 28 },
            { idx: 28, time: "1135ë…„", event: "ë¬˜ì²­ì˜ ì„œê²½ ì²œë„ ìš´ë™", person: "ë¬˜ì²­, ê¹€ë¶€ì‹", expression: "ì„œê²½ì— ëŒ€í™”ê¶ ì°½ê±´, ê¸ˆêµ­ ì •ë²Œ ë° ì¹­ì œ ê±´ì› ì£¼ì¥, ê¹€ë¶€ì‹ì— ì˜í•´ ì§„ì••", era: "goryeo", order: 29 },
            { idx: 29, time: "1170ë…„", event: "ë¬´ì‹ ì •ë³€ê³¼ ë¬´ì‹  ì •ê¶Œ", person: "ì •ì¤‘ë¶€, ì´ì˜ë°©, ìµœì¶©í—Œ, ìµœìš°", expression: "ë³´í˜„ì› ì‚¬ê±´ìœ¼ë¡œ ë¬´ì‹  ì •ê¶Œ ì„±ë¦½, êµì •ë„ê°(ê¶Œë ¥ ê¸°êµ¬) ë° ì •ë°© ì„¤ì¹˜", era: "goryeo", order: 30 },
            { idx: 30, time: "14ì„¸ê¸° (ê³ ë ¤ ë§)", event: "í™”í†µë„ê° ì„¤ì¹˜ì™€ ì™œêµ¬ ê²©í‡´", person: "ìµœë¬´ì„ ", expression: "í™”í¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§„í¬ ëŒ€ì²©ì—ì„œ ì™œêµ¬ë¥¼ ë¬¼ë¦¬ì¹¨", era: "goryeo", order: 31 },
            { idx: 31, time: "ì¡°ì„  ì‹œëŒ€ (íƒœì¡°)", event: "ì œ1ì°¨ ì™•ìì˜ ë‚œ", person: "ì´ì„±ê³„, ì´ë°©ì›, ì´ë°©ì„", expression: "ì„¸ì ì±…ë´‰ ë¬¸ì œë¡œ ì´ë°©ì›ì´ ì •ë„ì „ê³¼ ì´ë°©ì„ ë“±ì„ ì œê±°í•¨", era: "joseon-early", order: 32 },
            { idx: 32, time: "ì¡°ì„  ì‹œëŒ€ (íƒœì¢…)", event: "ì„¸ê³„ ì§€ë„ ì œì‘", person: "íƒœì¢…", expression: "í˜¼ì¼ê°•ë¦¬ì—­ëŒ€êµ­ë„ì§€ë„ ì œì‘(ë™ì–‘ ìµœê³  ì„¸ê³„ ì§€ë„)", era: "joseon-early", order: 33 },
            { idx: 33, time: "15ì„¸ê¸° (ì„¸ì¢…)", event: "ì„¸ì¢…ì˜ ì—…ì ê³¼ ë¯¼ì¡± ë¬¸í™” ë°œë‹¬", person: "ì„¸ì¢…, ì¥ì˜ì‹¤, ì •ì´ˆ", expression: "í›ˆë¯¼ì •ìŒ ì°½ì œ, ì•™ë¶€ì¼êµ¬ ë“± ê³¼í•™ ê¸°êµ¬ ì œì‘, ë†ì‚¬ì§ì„¤ í¸ì°¬, ì‚¼ê°•í–‰ì‹¤ë„", era: "joseon-early", order: 34 },
            { idx: 34, time: "ì¡°ì„  ì‹œëŒ€ (ì„±ì¢…)", event: "ê²½êµ­ëŒ€ì „ ì™„ì„±", person: "ì„±ì¢…", expression: "ì¡°ì„ ì˜ í†µì¹˜ ì²´ì œë¥¼ í™•ë¦½í•œ ê¸°ë³¸ ë²•ì „ ì™„ì„±", era: "joseon-early", order: 35 },
            { idx: 35, time: "ì¡°ì„  16ì„¸ê¸°", event: "ë¶•ë‹¹ì˜ í˜•ì„±", person: "ì‚¬ë¦¼ (ê¹€íš¨ì›, ì‹¬ì˜ê²¸)", expression: "ì´ì¡° ì „ë‘ ì„ëª…ê¶Œì„ ë‘˜ëŸ¬ì‹¼ ê°ˆë“±ìœ¼ë¡œ ë™ì¸ê³¼ ì„œì¸ ë¶„í™”", era: "joseon-early", order: 36 },
            { idx: 36, time: "1592ë…„", event: "ì„ì§„ì™œë€", person: "ì„ ì¡°, ì´ìˆœì‹ , ê³½ì¬ìš°, ì •ë¬¸ë¶€", expression: "ì˜ë³‘ í™œë™(í™ì˜ì¥êµ° ê³½ì¬ìš°), ë¹„ë³€ì‚¬ ê°•í™” ë° í›ˆë ¨ë„ê° ì„¤ì¹˜ì˜ ê³„ê¸°", era: "joseon-early", order: 37 },
            { idx: 37, time: "1608ë…„ (ê´‘í•´êµ°)", event: "ëŒ€ë™ë²• ì‹¤ì‹œ", person: "ê´‘í•´êµ°, ì´ì›ìµ, ê¹€ìœ¡", expression: "ê³µë‚©ì„ ìŒ€ ë“±ìœ¼ë¡œ í†µì¼í•˜ì—¬ ë¶€ê³¼, ê³µì¸ì˜ ë“±ì¥ ë°°ê²½ì´ ë¨", era: "joseon-late", order: 38 },
            { idx: 38, time: "1623ë…„", event: "ì¸ì¡°ë°˜ì •", person: "ì¸ì¡°, ì„œì¸ ì„¸ë ¥, ê´‘í•´êµ°", expression: "ê´‘í•´êµ°ì˜ ì¤‘ë¦½ ì™¸êµì™€ íëª¨ì‚´ì œë¥¼ êµ¬ì‹¤ë¡œ ë°œìƒ, ì¹œëª…ë°°ê¸ˆ ì •ì±… ì¶”ì§„", era: "joseon-late", order: 39 },
            { idx: 39, time: "18ì„¸ê¸° (ì •ì¡°)", event: "ì •ì¡°ì˜ ì™•ê¶Œ ê°•í™” ì •ì±…", person: "ì •ì¡°", expression: "êµ­ì™• ì¹œìœ„ ë¶€ëŒ€ ì¥ìš©ì˜ ì„¤ì¹˜, ì´ˆê³„ë¬¸ì‹ ì œ ì‹¤ì‹œ, ê·œì¥ê° ê°•í™”", era: "joseon-late", order: 40 },
            { idx: 40, time: "18ì„¸ê¸° í›„ë°˜", event: "ì‹¤í•™ (ì¤‘ìƒí•™íŒŒ) ë° ê²½ì œ ë³€í™”", person: "ë°•ì§€ì›, ë°•ì œê°€, ë•ëŒ€", expression: "ë¶í•™ì˜ì—ì„œ ì†Œë¹„ ê¶Œì¥, ê´‘ì‚° ê²½ì˜ì˜ ì „ë¬¸ ê²½ì˜ì¸ ë•ëŒ€ ë“±ì¥", era: "joseon-late", order: 41 },
            { idx: 41, time: "1811ë…„ / 1862ë…„", event: "ì¡°ì„  í›„ê¸° ë†ë¯¼ ë´‰ê¸°", person: "í™ê²½ë˜, ìœ ê³„ì¶˜, ë°•ê·œìˆ˜", expression: "í™ê²½ë˜ì˜ ë‚œ(ì§€ì—­ ì°¨ë³„), ì„ìˆ  ë†ë¯¼ ë´‰ê¸°(ì‚¼ì •ì˜ ë¬¸ë€), ì‚¼ì •ì´ì •ì²­ ì„¤ì¹˜", era: "joseon-late", order: 42 },
            { idx: 42, time: "1860ë…„ëŒ€", event: "í¥ì„  ëŒ€ì›êµ°ì˜ ê°œí˜ê³¼ ëŒ€ì™¸ ì •ì±…", person: "í¥ì„  ëŒ€ì›êµ°, ì–‘í—Œìˆ˜", expression: "ê²½ë³µê¶ ì¤‘ê±´, ì„œì› ì •ë¦¬, ë³‘ì¸ì–‘ìš” ì‹œ ì •ì¡±ì‚°ì„± í•­ì „, ì²™í™”ë¹„ ê±´ë¦½", era: "joseon-late", order: 43 },
            { idx: 43, time: "1884ë…„", event: "ê°‘ì‹ ì •ë³€", person: "ê¹€ì˜¥ê· , ë°•ì˜íš¨, í™ì˜ì‹", expression: "ìš°ì •ì´êµ­ ê°œêµ­ ì¶•í•˜ì—°ì„ ì´ìš©í•œ ì •ë³€, 14ê°œì¡° ê°œí˜ ì •ê°• ë°œí‘œ", era: "modern", order: 44 },
            { idx: 44, time: "1894ë…„", event: "ë™í•™ ë†ë¯¼ ìš´ë™", person: "ì „ë´‰ì¤€, ê¹€ê°œë‚¨, ì†í™”ì¤‘", expression: "ì§‘ê°•ì†Œ ì„¤ì¹˜, íì • ê°œí˜ì•ˆ ì‹¤ì²œ, í™©í† í˜„/ìš°ê¸ˆì¹˜ ì „íˆ¬", era: "modern", order: 45 },
            { idx: 45, time: "1894ë…„ (ê°‘ì˜¤ê°œí˜)", event: "ê°‘ì˜¤ê°œí˜", person: "ê¹€í™ì§‘, êµ°êµ­ê¸°ë¬´ì²˜", expression: "ì‹ ë¶„ì œ(ê³µì‚¬ ë…¸ë¹„ë²•) íì§€, ê³¼ê±°ì œ íì§€", era: "modern", order: 46 },
            { idx: 46, time: "1905ë…„", event: "ì„ì‚¬ëŠ‘ì•½ê³¼ êµ­ê¶Œ ìˆ˜í˜¸ ìš´ë™", person: "ì´í†  íˆë¡œë¶€ë¯¸, ë¯¼ì˜í™˜, ì¥ì§€ì—°", expression: "ì™¸êµê¶Œ ë°•íƒˆ, í¬ì¸ ë¨¸ìŠ¤ ì¡°ì•½ ë°°ê²½, ë¯¼ì˜í™˜ì˜ ìê²°, ì‹œì¼ì•¼ë°©ì„±ëŒ€ê³¡ ë°œí‘œ", era: "modern", order: 47 },
            { idx: 47, time: "ëŒ€í•œì œêµ­ ë§ê¸°", event: "ìŠ¤í‹°ë¸ìŠ¤ ì‚¬ì‚´ ë° êµ­ë¬¸ ì—°êµ¬ì†Œ", person: "ì¥ì¸í™˜, ì „ëª…ìš´, ì£¼ì‹œê²½", expression: "ìƒŒí”„ë€ì‹œìŠ¤ì½”ì—ì„œ ìŠ¤í‹°ë¸ìŠ¤ ì²˜ë‹¨, í•™ë¶€ ì‚°í•˜ êµ­ë¬¸ ì—°êµ¬ì†Œ ì„¤ì¹˜", era: "modern", order: 48 },
            { idx: 48, time: "1910ë…„ëŒ€", event: "ë¬´ë‹¨ í†µì¹˜ì™€ ì¡°ì„  íƒœí˜•ë ¹", person: "í—Œë³‘ ê²½ì°°", expression: "í—Œë³‘ì´ ê²½ì°° ì—…ë¬´ ë‹´ë‹¹, ì¡°ì„ ì¸ì—ê²Œë§Œ ì ìš©ë˜ëŠ” ì¡°ì„  íƒœí˜•ë ¹ ì‹œí–‰", era: "modern", order: 49 },
            { idx: 49, time: "1919ë…„", event: "3Â·1 ìš´ë™", person: "ë¯¼ì¡± ëŒ€í‘œ 33ì¸, ìœ ê´€ìˆœ", expression: "ë…ë¦½ ì„ ì–¸ì„œ ë°œí‘œ, ëŒ€í•œë¯¼êµ­ ì„ì‹œ ì •ë¶€ ìˆ˜ë¦½ì˜ ê³„ê¸°, ë¬¸í™” í†µì¹˜ ì „í™˜", era: "modern", order: 50 },
            { idx: 50, time: "1920ë…„ëŒ€", event: "ì‹ ê°„íšŒì™€ ê´‘ì£¼ í•™ìƒ í•­ì¼ ìš´ë™", person: "ì‹ ê°„íšŒ, ì´ìƒì¬, í™ëª…í¬", expression: "ë¹„íƒ€í˜‘ì  ë¯¼ì¡±ì£¼ì˜ì™€ ì‚¬íšŒì£¼ì˜ ì—°í•©, ê´‘ì£¼ í•™ìƒ í•­ì¼ ìš´ë™ì— ì¡°ì‚¬ë‹¨ íŒŒê²¬", era: "modern", order: 51 },
            { idx: 51, time: "1940ë…„ëŒ€", event: "ê±´êµ­ ì¤€ë¹„ í™œë™", person: "ì—¬ìš´í˜•, ì¡°ì„  ê±´êµ­ ë™ë§¹", expression: "ì¼ë³¸ íŒ¨ë§ì— ëŒ€ë¹„í•œ ë¹„ë°€ ê²°ì‚¬, ê´‘ë³µ í›„ ì¡°ì„ ê±´êµ­ì¤€ë¹„ìœ„ì›íšŒë¡œ ê°œí¸", era: "modern", order: 52 },
            { idx: 52, time: "1948ë…„", event: "ëŒ€í•œë¯¼êµ­ ì •ë¶€ ìˆ˜ë¦½", person: "ì´ìŠ¹ë§Œ, ê¹€êµ¬", expression: "5Â·10 ì´ì„ ê±°ë¡œ ì œí—Œ êµ­íšŒ êµ¬ì„±, ëŒ€í•œë¯¼êµ­ ì •ë¶€ ìˆ˜ë¦½ ì„ í¬", era: "modern", order: 53 },
            { idx: 53, time: "ì´ìŠ¹ë§Œ ì •ë¶€", event: "4Â·19 í˜ëª… ë° ë†ì§€ ê°œí˜", person: "ì´ìŠ¹ë§Œ, ê¹€ì£¼ì—´", expression: "3Â·15 ë¶€ì • ì„ ê±° í•­ê±°, ì´ìŠ¹ë§Œ í•˜ì•¼, ìœ ìƒ ë§¤ì… ìœ ìƒ ë¶„ë°° ë†ì§€ ê°œí˜", era: "modern", order: 54 },
            { idx: 54, time: "1980ë…„", event: "5Â·18 ë¯¼ì£¼í™” ìš´ë™", person: "ì‹œë¯¼êµ°, ìœ¤ìƒì›, ë°•ê¸°ìˆœ", expression: "ì‹ êµ°ë¶€ì˜ ë¹„ìƒê³„ì—„ í™•ëŒ€ ì €í•­, ì‹œë¯¼êµ° ì¡°ì§, ì„¸ê³„ ê¸°ë¡ ìœ ì‚° ë“±ì¬", era: "modern", order: 55 },
            { idx: 55, time: "1987ë…„", event: "6ì›” ë¯¼ì£¼ í•­ìŸ", person: "ë°•ì¢…ì² , ì´í•œì—´, ë…¸íƒœìš°", expression: "4Â·13 í˜¸í—Œ ì¡°ì¹˜ ì² í ìš”êµ¬, 6Â·29 ë¯¼ì£¼í™” ì„ ì–¸(ëŒ€í†µë ¹ ì§ì„ ì œ) ì´ëŒì–´ ëƒ„", era: "modern", order: 56 },
            { idx: 56, time: "ê¹€ì˜ì‚¼ ì •ë¶€", event: "ê¹€ì˜ì‚¼ ì •ë¶€ì˜ ê°œí˜", person: "ê¹€ì˜ì‚¼", expression: "ê¸ˆìœµ ì‹¤ëª…ì œ ì‹¤ì‹œ, ì¡°ì„  ì´ë…ë¶€ ì² ê±°, ì—­ì‚¬ ë°”ë¡œ ì„¸ìš°ê¸°, ì „ì§ ëŒ€í†µë ¹ ì²˜ë²Œ", era: "modern", order: 57 }
        ];

        // Role classification based on keywords
        function classifyRole(person, expression, event) {
            const p = person.toLowerCase();
            const e = expression.toLowerCase();
            const ev = event.toLowerCase();
            
            // King/Ruler
            if (p.includes('ì™•') || p.includes('íƒœì¡°') || p.includes('íƒœì¢…') || p.includes('ì„¸ì¢…') || 
                p.includes('ì„±ì¢…') || p.includes('ê´‘í•´êµ°') || p.includes('ì¸ì¡°') || p.includes('ì •ì¡°') ||
                p.includes('ë‹¨êµ°') || p.includes('ëŒ€ì¡°ì˜') || p.includes('ê´‘ê°œí† ') || p.includes('ì¥ìˆ˜ì™•') ||
                p.includes('ê·¼ì´ˆê³ ì™•') || p.includes('ì†Œìˆ˜ë¦¼ì™•') || p.includes('ì§€ì¦ì™•') || p.includes('ë¬¸ë¬´ì™•') ||
                p.includes('ì‹ ë¬¸ì™•') || p.includes('ê´‘ì¢…') || p.includes('ê²¬í›¤') || p.includes('ì´ì„±ê³„') ||
                p.includes('ì´ìŠ¹ë§Œ') || p.includes('ê¹€ì˜ì‚¼') || e.includes('ê±´êµ­') || e.includes('ì™•ìœ„')) {
                return 'king';
            }
            
            // Military
            if (p.includes('ì„ì§€ë¬¸ë•') || p.includes('ê³„ë°±') || p.includes('ê¹€ìœ ì‹ ') || p.includes('ê°•ê°ì°¬') ||
                p.includes('ìœ¤ê´€') || p.includes('ì´ìˆœì‹ ') || p.includes('ê³½ì¬ìš°') || p.includes('ì–‘í—Œìˆ˜') ||
                p.includes('ì‹œë¯¼êµ°') || e.includes('ê²©í‡´') || e.includes('ëŒ€ì²©') || e.includes('ì „íˆ¬') ||
                e.includes('í•­ì „') || e.includes('ì •ë²Œ')) {
                return 'military';
            }
            
            // Rebel/Revolutionary
            if (p.includes('ì—°ê°œì†Œë¬¸') || p.includes('ê¹€í—Œì°½') || p.includes('ë¬˜ì²­') || p.includes('ì •ì¤‘ë¶€') ||
                p.includes('ì´ë°©ì›') || p.includes('ê¹€ì˜¥ê· ') || p.includes('ì „ë´‰ì¤€') || p.includes('í™ê²½ë˜') ||
                ev.includes('ì •ë³€') || ev.includes('ë‚œ') || ev.includes('í˜ëª…') || ev.includes('ìš´ë™') ||
                e.includes('ì •ë³€') || e.includes('ë´‰ê¸°') || e.includes('í•­ìŸ') || e.includes('ì œê±°')) {
                return 'rebel';
            }
            
            // Scholar/Reformer
            if (p.includes('ìµœìŠ¹ë¡œ') || p.includes('ê¹€ë¶€ì‹') || p.includes('ì¥ì˜ì‹¤') || p.includes('ë°•ì§€ì›') ||
                p.includes('ë°•ì œê°€') || p.includes('ì£¼ì‹œê²½') || p.includes('ì‚¬ë¦¼') || p.includes('ìŒê¸°') ||
                e.includes('ì‹¤í•™') || e.includes('ì°½ì œ') || e.includes('í¸ì°¬') || e.includes('ì—°êµ¬')) {
                return 'scholar';
            }
            
            // Minister/Official
            if (p.includes('ì„íŒŒì†Œ') || p.includes('ì„œí¬') || p.includes('ì´ì›ìµ') || p.includes('ê¹€ìœ¡') ||
                p.includes('ìµœë¬´ì„ ') || p.includes('ê¹€í™ì§‘') || e.includes('ê´€ë£Œ') || e.includes('ì‹œë¬´') ||
                e.includes('ê±´ì˜') || e.includes('ì •ë¹„')) {
                return 'minister';
            }
            
            // Foreign
            if (p.includes('í•œ ë¬´ì œ') || p.includes('ë‹¹') || p.includes('ìˆ˜ë‚˜ë¼') || p.includes('ê±°ë€') ||
                p.includes('ì—¬ì§„') || p.includes('ì™œ') || p.includes('ì´í† ') || p.includes('í—Œë³‘')) {
                return 'foreign';
            }
            
            // People/Group
            if (p.includes('ë¯¼ì¡±') || p.includes('ì‹ ê°„íšŒ') || p.includes('ì§‘ë‹¨') || p.includes('ì¸') ||
                p.includes('í˜¸ì¡±') || p.includes('ì„¸ë ¥') || p.includes('33ì¸')) {
                return 'people';
            }
            
            return 'default';
        }

        // Extract conceptual role transformation from expression
        function extractRoleTransition(expression, event) {
            const transitions = [];
            
            // Pattern matching for role transitions
            if (expression.includes('ê±´êµ­')) transitions.push('ê±´êµ­ì');
            if (expression.includes('ì°¬íƒˆ')) transitions.push('ì°¬íƒˆì â†’ êµ°ì£¼');
            if (expression.includes('ë§ëª…')) transitions.push('ë§ëª…ì');
            if (expression.includes('í•­ì „')) transitions.push('ì €í•­ì');
            if (expression.includes('ì •ë³€')) transitions.push('ë°˜ë€ì â†’ ê¶Œë ¥ì');
            if (expression.includes('ê²©í‡´') || expression.includes('ëŒ€ì²©')) transitions.push('êµ¬êµ­ì˜ì›…');
            if (expression.includes('í†µì¼')) transitions.push('í†µì¼êµ°ì£¼');
            if (expression.includes('ê°œí˜') || expression.includes('ì •ë¹„')) transitions.push('ê°œí˜ê°€');
            if (expression.includes('ì„¤ì¹˜') || expression.includes('ì„¤ë¦½')) transitions.push('ì œë„ì„¤ê³„ì');
            if (expression.includes('ì°½ì œ') || expression.includes('ì œì‘')) transitions.push('ì°½ì¡°ì');
            if (expression.includes('ì§„ì••')) transitions.push('ì§„ì••ì');
            if (expression.includes('ìš´ë™') || expression.includes('í•­ìŸ')) transitions.push('ì €í•­ì§€ë„ì');
            if (expression.includes('ìê²°')) transitions.push('ìˆœêµ­ì');
            if (expression.includes('í•˜ì•¼')) transitions.push('í‡´ì§„ì');
            
            if (event.includes('ë©¸ë§')) transitions.push('ìµœí›„ì˜ ì €í•­');
            if (event.includes('ì „ì„±ê¸°')) transitions.push('ì „ì„±ê¸° êµ°ì£¼');
            if (event.includes('ì™•ê¶Œ ê°•í™”')) transitions.push('ê¶Œë ¥ê°•í™”ì');
            
            return transitions.length > 0 ? transitions.join(' â†’ ') : 'ì—­ì‚¬ì  í–‰ìœ„ì';
        }

        // Process data for flow visualization
        function processFlowData(filterEra = 'all', filterRole = 'all', searchTerm = '') {
            const personMap = new Map();
            const nodes = [];
            const links = [];
            
            // Filter and process data
            let filteredData = historyData.filter(item => {
                if (filterEra !== 'all' && item.era !== filterEra) return false;
                return true;
            });
            
            // Build person-timeline map
            filteredData.forEach(item => {
                const persons = item.person.split(/[,ï¼Œ]/).map(p => p.trim()).filter(p => p);
                
                persons.forEach(person => {
                    // Apply search filter
                    if (searchTerm && !person.includes(searchTerm)) return;
                    
                    const role = classifyRole(person, item.expression, item.event);
                    
                    // Apply role filter
                    if (filterRole !== 'all' && role !== filterRole) return;
                    
                    if (!personMap.has(person)) {
                        personMap.set(person, []);
                    }
                    
                    const transition = extractRoleTransition(item.expression, item.event);
                    
                    personMap.get(person).push({
                        person: person,
                        time: item.time,
                        event: item.event,
                        expression: item.expression,
                        role: role,
                        transition: transition,
                        order: item.order,
                        era: item.era
                    });
                });
            });
            
            // Create nodes and links
            let nodeId = 0;
            const nodeMap = new Map();
            
            personMap.forEach((appearances, person) => {
                // Sort by order
                appearances.sort((a, b) => a.order - b.order);
                
                let prevNodeId = null;
                
                appearances.forEach((app, idx) => {
                    const id = `node_${nodeId++}`;
                    const node = {
                        id: id,
                        person: person,
                        time: app.time,
                        event: app.event,
                        expression: app.expression,
                        role: app.role,
                        transition: app.transition,
                        order: app.order,
                        era: app.era,
                        appearanceIndex: idx
                    };
                    nodes.push(node);
                    nodeMap.set(id, node);
                    
                    // Create link to previous appearance
                    if (prevNodeId !== null) {
                        links.push({
                            source: prevNodeId,
                            target: id,
                            person: person
                        });
                    }
                    prevNodeId = id;
                });
            });
            
            return { nodes, links, personMap };
        }

        // Initialize Flow Visualization
        function initFlowVisualization() {
            const container = document.getElementById('flow-graph-container');
            const svg = d3.select('#flow-graph');
            
            const filterEra = document.getElementById('era-filter').value;
            const filterRole = document.getElementById('role-filter').value;
            const searchTerm = document.getElementById('person-search').value;
            
            const { nodes, links, personMap } = processFlowData(filterEra, filterRole, searchTerm);
            
            if (nodes.length === 0) {
                svg.selectAll('*').remove();
                svg.append('text')
                    .attr('x', 400)
                    .attr('y', 300)
                    .attr('fill', 'var(--text-secondary)')
                    .attr('text-anchor', 'middle')
                    .text('í•„í„° ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // Calculate dimensions
            const uniquePersons = Array.from(personMap.keys());
            const uniqueOrders = [...new Set(nodes.map(n => n.order))].sort((a, b) => a - b);
            
            const margin = { top: 80, right: 50, bottom: 50, left: 180 };
            const nodeWidth = 120;
            const nodeHeight = 40;
            const xSpacing = 140;
            const ySpacing = 60;
            
            const width = Math.max(margin.left + margin.right + uniqueOrders.length * xSpacing, 2000);
            const height = Math.max(margin.top + margin.bottom + uniquePersons.length * ySpacing, 700);
            
            svg.attr('width', width).attr('height', height);
            svg.selectAll('*').remove();
            
            // Create scales
            const xScale = d3.scaleLinear()
                .domain([d3.min(uniqueOrders), d3.max(uniqueOrders)])
                .range([margin.left, width - margin.right - nodeWidth]);
            
            const yScale = d3.scaleBand()
                .domain(uniquePersons)
                .range([margin.top, height - margin.bottom])
                .padding(0.3);
            
            // Color scale for roles
            const roleColors = {
                king: 'var(--accent-gold)',
                minister: 'var(--accent-jade)',
                military: 'var(--accent-indigo)',
                rebel: 'var(--accent-crimson)',
                scholar: 'var(--accent-purple)',
                foreign: '#6b8fd4',
                people: 'var(--accent-teal)',
                default: '#5a5a6a'
            };
            
            // Draw time axis
            const timeAxisG = svg.append('g').attr('class', 'time-axis');
            
            timeAxisG.append('line')
                .attr('class', 'time-axis-line')
                .attr('x1', margin.left)
                .attr('y1', margin.top - 30)
                .attr('x2', width - margin.right)
                .attr('y2', margin.top - 30);
            
            // Time labels (sample)
            const timeLabels = nodes.filter((n, i, arr) => 
                arr.findIndex(m => m.order === n.order) === i
            ).sort((a, b) => a.order - b.order);
            
            timeLabels.forEach(n => {
                const x = xScale(n.order) + nodeWidth / 2;
                
                timeAxisG.append('line')
                    .attr('class', 'time-tick')
                    .attr('x1', x)
                    .attr('y1', margin.top - 35)
                    .attr('x2', x)
                    .attr('y2', margin.top - 25);
                
                timeAxisG.append('text')
                    .attr('class', 'time-label')
                    .attr('x', x)
                    .attr('y', margin.top - 45)
                    .attr('text-anchor', 'middle')
                    .text(n.time.length > 12 ? n.time.substring(0, 12) + '...' : n.time);
            });
            
            // Draw person lanes
            const lanesG = svg.append('g').attr('class', 'person-lanes');
            
            uniquePersons.forEach(person => {
                const y = yScale(person) + yScale.bandwidth() / 2;
                
                lanesG.append('line')
                    .attr('class', 'person-lane')
                    .attr('x1', margin.left - 10)
                    .attr('y1', y)
                    .attr('x2', width - margin.right)
                    .attr('y2', y);
                
                lanesG.append('text')
                    .attr('class', 'person-lane-label')
                    .attr('x', margin.left - 15)
                    .attr('y', y + 4)
                    .attr('text-anchor', 'end')
                    .text(person.length > 15 ? person.substring(0, 15) + '...' : person);
            });
            
            // Draw links (curved arrows)
            const linksG = svg.append('g').attr('class', 'flow-links');
            
            // Arrow marker
            svg.append('defs').append('marker')
                .attr('id', 'flow-arrow')
                .attr('viewBox', '0 0 10 10')
                .attr('refX', 9)
                .attr('refY', 5)
                .attr('markerWidth', 6)
                .attr('markerHeight', 6)
                .attr('orient', 'auto-start-reverse')
                .append('path')
                .attr('d', 'M 0 0 L 10 5 L 0 10 z')
                .attr('class', 'flow-arrow');
            
            const nodePositions = new Map();
            nodes.forEach(n => {
                const x = xScale(n.order);
                const y = yScale(n.person) + yScale.bandwidth() / 2 - nodeHeight / 2;
                nodePositions.set(n.id, { x, y, node: n });
            });
            
            links.forEach(link => {
                const source = nodePositions.get(link.source);
                const target = nodePositions.get(link.target);
                
                if (!source || !target) return;
                
                const x1 = source.x + nodeWidth;
                const y1 = source.y + nodeHeight / 2;
                const x2 = target.x;
                const y2 = target.y + nodeHeight / 2;
                
                const midX = (x1 + x2) / 2;
                const curveOffset = Math.abs(y2 - y1) > 10 ? 30 : 0;
                
                const path = `M ${x1} ${y1} C ${midX + curveOffset} ${y1}, ${midX - curveOffset} ${y2}, ${x2} ${y2}`;
                
                linksG.append('path')
                    .attr('class', 'flow-link')
                    .attr('d', path)
                    .attr('stroke', roleColors[source.node.role] || '#5a5a6a')
                    .attr('marker-end', 'url(#flow-arrow)');
            });
            
            // Draw nodes
            const nodesG = svg.append('g').attr('class', 'flow-nodes');
            const tooltip = document.getElementById('tooltip');
            
            nodes.forEach(n => {
                const pos = nodePositions.get(n.id);
                if (!pos) return;
                
                const nodeG = nodesG.append('g')
                    .attr('class', 'role-node')
                    .attr('transform', `translate(${pos.x}, ${pos.y})`);
                
                nodeG.append('rect')
                    .attr('width', nodeWidth)
                    .attr('height', nodeHeight)
                    .attr('class', `role-${n.role}`)
                    .style('fill', roleColors[n.role] || '#5a5a6a');
                
                // Role label (short)
                const shortTransition = n.transition.length > 15 ? 
                    n.transition.substring(0, 15) + '...' : n.transition;
                
                nodeG.append('text')
                    .attr('x', nodeWidth / 2)
                    .attr('y', nodeHeight / 2 - 5)
                    .attr('text-anchor', 'middle')
                    .attr('font-weight', '600')
                    .text(n.person.length > 10 ? n.person.substring(0, 10) + '...' : n.person);
                
                nodeG.append('text')
                    .attr('x', nodeWidth / 2)
                    .attr('y', nodeHeight / 2 + 10)
                    .attr('text-anchor', 'middle')
                    .attr('font-size', '8px')
                    .attr('fill', 'rgba(255,255,255,0.8)')
                    .text(shortTransition);
                
                // Tooltip events
                nodeG.on('mouseover', function(event) {
                    const roleNames = {
                        king: 'ì™•/êµ°ì£¼', minister: 'ì‹ í•˜/ê´€ë£Œ', military: 'ë¬´ì¥/ì¥êµ°',
                        rebel: 'ë°˜ë€/ì €í•­', scholar: 'í•™ì/ì‹¤í•™', foreign: 'ì™¸ì„¸/ì™¸êµ­',
                        people: 'ë¯¼ì¤‘/ì§‘ë‹¨', default: 'ê¸°íƒ€'
                    };
                    
                    tooltip.innerHTML = `
                        <div class="tooltip-title">${n.person}</div>
                        <div class="tooltip-time">ğŸ“… ${n.time}</div>
                        <div class="tooltip-role">
                            <div class="tooltip-role-badge" style="background: ${roleColors[n.role]};"></div>
                            ${roleNames[n.role] || 'ê¸°íƒ€'}
                        </div>
                        <div class="tooltip-transition">ğŸ”„ ì—­í•  ë³€í™”: ${n.transition}</div>
                        <div class="tooltip-expression">
                            <strong>ğŸ“œ ì‚¬ê±´:</strong> ${n.event}<br><br>
                            <strong>ğŸ“ í•µì‹¬ í‘œí˜„:</strong> ${n.expression}
                        </div>
                    `;
                    tooltip.style.display = 'block';
                    tooltip.style.left = (event.clientX + 15) + 'px';
                    tooltip.style.top = (event.clientY + 15) + 'px';
                })
                .on('mousemove', function(event) {
                    tooltip.style.left = (event.clientX + 15) + 'px';
                    tooltip.style.top = (event.clientY + 15) + 'px';
                })
                .on('mouseout', function() {
                    tooltip.style.display = 'none';
                });
            });
        }

        // Initialize Timeline
        function initTimeline() {
            const container = document.getElementById('timeline-container');
            container.innerHTML = '';
            
            historyData.forEach((item, index) => {
                const timelineItem = document.createElement('div');
                timelineItem.className = 'timeline-item';
                timelineItem.style.animationDelay = `${index * 0.05}s`;
                
                const persons = item.person.split(/[,ï¼Œ]/).map(p => p.trim()).filter(p => p);
                const personItems = persons.map(p => `
                    <div class="person-item">
                        <div class="person-header" onclick="togglePerson(this)">
                            <span class="person-name">${p}</span>
                            <span class="person-toggle">â–¶</span>
                        </div>
                        <div class="expression-content">
                            <div class="expression-inner">
                                <div class="expression-label">í•µì‹¬ í‘œí˜„</div>
                                <div class="expression-text">${item.expression}</div>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                timelineItem.innerHTML = `
                    <div class="event-card">
                        <div class="event-header" onclick="toggleEvent(this)">
                            <div>
                                <span class="event-time">${item.time}</span>
                                <h3 class="event-title">${item.event}</h3>
                            </div>
                            <span class="toggle-icon">â–¼</span>
                        </div>
                        <div class="event-content">
                            <div class="content-inner">
                                <div class="person-section">
                                    <div class="person-label">ê´€ë ¨ ì¸ë¬¼ ë˜ëŠ” ì§‘ë‹¨</div>
                                    ${personItems}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(timelineItem);
            });
        }

        function toggleEvent(header) {
            const card = header.closest('.event-card');
            card.classList.toggle('open');
        }

        function togglePerson(header) {
            const item = header.closest('.person-item');
            item.classList.toggle('open');
        }

        // Cluster Analysis
        function performClusterAnalysis() {
            return [
                { id: 1, name: "ì„ ì‚¬ ì‹œëŒ€ì™€ ê³ ëŒ€ êµ­ê°€ í˜•ì„±ê¸°", color: "#d4a574", period: "êµ¬ì„ê¸° ~ BC 1ì„¸ê¸°", keywords: ["ë—€ì„ê¸°", "ë†ê²½", "ì •ì°©", "ê³ ì¸ëŒ", "ë²”ê¸ˆ8ì¡°", "ì² ê¸°", "ì œì²œí–‰ì‚¬"], events: historyData.slice(0, 7), characteristics: "ë„êµ¬ ë°œì „, ë†ê²½ ì‹œì‘, ê³„ê¸‰ ì‚¬íšŒ í˜•ì„±, ê³ ì¡°ì„  ê±´êµ­ê³¼ ë©¸ë§" },
                { id: 2, name: "ì‚¼êµ­ ì‹œëŒ€ì™€ ì˜í†  ê²½ìŸ", color: "#7eb8a2", period: "1ì„¸ê¸° ~ 7ì„¸ê¸°", keywords: ["ì „ì„±ê¸°", "ì˜í† í™•ì¥", "ì²œë„", "ì²´ì œì •ë¹„", "ë¶ˆêµìˆ˜ìš©", "ëŒ€ì²©", "í†µì¼"], events: historyData.slice(7, 18), characteristics: "ì‚¼êµ­ì˜ ì„±ì¥ê³¼ ê²½ìŸ, ë¶ˆêµì™€ ìœ¨ë ¹ ìˆ˜ìš©, ëŒ€ì™¸ í•­ìŸ" },
                { id: 3, name: "í†µì¼ì‹ ë¼ì™€ ë°œí•´", color: "#6b7fd4", period: "7ì„¸ê¸° ~ 10ì„¸ê¸°", keywords: ["ì™•ê¶Œê°•í™”", "ë…¹ìíì§€", "5ê²½15ë¶€", "í˜¸ì¡±", "í›„ì‚¼êµ­"], events: historyData.slice(18, 23), characteristics: "ì¤‘ì•™ì§‘ê¶Œ ê°•í™”, ë°œí•´ ê±´êµ­, ì§€ë°© í˜¸ì¡± ì„±ì¥" },
                { id: 4, name: "ê³ ë ¤ ì‹œëŒ€", color: "#c9534a", period: "918ë…„ ~ 14ì„¸ê¸°", keywords: ["ê³¼ê±°ì œ", "ê±°ë€ì¹¨ì…", "ë³„ë¬´ë°˜", "ë¬´ì‹ ì •ê¶Œ", "í™”í¬"], events: historyData.slice(23, 31), characteristics: "ë¬¸ë²Œ ê·€ì¡± ì‚¬íšŒ, ì™¸ì¹¨ ê·¹ë³µ, ë¬´ì‹  ì •ê¶Œ" },
                { id: 5, name: "ì¡°ì„  ì „ê¸°", color: "#9a7fd4", period: "14ì„¸ê¸° ~ 16ì„¸ê¸°", keywords: ["í›ˆë¯¼ì •ìŒ", "ê²½êµ­ëŒ€ì „", "ì‚¬ë¦¼", "ë¶•ë‹¹", "ì˜ë³‘"], events: historyData.slice(31, 37), characteristics: "ìœ êµì  í†µì¹˜ ì²´ì œ í™•ë¦½, ë¯¼ì¡± ë¬¸í™” ë°œë‹¬" },
                { id: 6, name: "ì¡°ì„  í›„ê¸°", color: "#5fb4a2", period: "17ì„¸ê¸° ~ 19ì„¸ê¸°", keywords: ["ëŒ€ë™ë²•", "íƒ•í‰", "ì‹¤í•™", "ë†ë¯¼ë´‰ê¸°", "ê°œí˜"], events: historyData.slice(37, 43), characteristics: "ì œë„ ê°œí˜, ì‹¤í•™ ë°œë‹¬, ì„¸ë„ ì •ì¹˜" },
                { id: 7, name: "ê·¼í˜„ëŒ€", color: "#6b8fd4", period: "1884ë…„ ~ í˜„ì¬", keywords: ["ê°œí™”", "ë…ë¦½ìš´ë™", "ë¯¼ì£¼í™”", "í†µì¼"], events: historyData.slice(43), characteristics: "ê·¼ëŒ€í™”, ì¼ì œê°•ì ê¸°, ë¯¼ì£¼í™” ìš´ë™" }
            ];
        }

        function initCluster() {
            const clusters = performClusterAnalysis();
            const chartContainer = document.getElementById('cluster-chart');
            const detailsContainer = document.getElementById('cluster-details');
            
            const width = chartContainer.clientWidth - 40;
            const height = 180;
            
            chartContainer.innerHTML = `<svg width="${width}" height="${height}"></svg>`;
            
            const svg = d3.select(chartContainer).select('svg');
            const barWidth = (width - 100) / clusters.length;
            
            svg.selectAll('rect')
                .data(clusters)
                .join('rect')
                .attr('x', (d, i) => 50 + i * barWidth)
                .attr('y', 40)
                .attr('width', barWidth - 10)
                .attr('height', 50)
                .attr('fill', d => d.color)
                .attr('rx', 6)
                .style('cursor', 'pointer')
                .on('click', (event, d) => {
                    document.getElementById(`cluster-${d.id}`).scrollIntoView({ behavior: 'smooth' });
                });
            
            svg.selectAll('.cluster-label')
                .data(clusters)
                .join('text')
                .attr('class', 'cluster-label')
                .attr('x', (d, i) => 50 + i * barWidth + (barWidth - 10) / 2)
                .attr('y', 70)
                .attr('text-anchor', 'middle')
                .attr('fill', '#0a0a0f')
                .attr('font-size', '9px')
                .attr('font-weight', '600')
                .text(d => d.name.length > 8 ? d.name.substring(0, 8) + '..' : d.name);
            
            svg.selectAll('.period-label')
                .data(clusters)
                .join('text')
                .attr('x', (d, i) => 50 + i * barWidth + (barWidth - 10) / 2)
                .attr('y', 110)
                .attr('text-anchor', 'middle')
                .attr('fill', '#9a9590')
                .attr('font-size', '8px')
                .text(d => d.period);
            
            svg.append('path')
                .attr('d', `M 50 140 L ${width - 50} 140`)
                .attr('stroke', '#3a3a4a')
                .attr('stroke-width', 2)
                .attr('marker-end', 'url(#arrow)');
            
            svg.append('defs').append('marker')
                .attr('id', 'arrow')
                .attr('viewBox', '0 0 10 10')
                .attr('refX', 9)
                .attr('refY', 5)
                .attr('markerWidth', 6)
                .attr('markerHeight', 6)
                .attr('orient', 'auto-start-reverse')
                .append('path')
                .attr('d', 'M 0 0 L 10 5 L 0 10 z')
                .attr('fill', '#3a3a4a');
            
            svg.append('text')
                .attr('x', width - 40)
                .attr('y', 155)
                .attr('fill', '#9a9590')
                .attr('font-size', '10px')
                .text('ì‹œê°„ â†’');
            
            detailsContainer.innerHTML = clusters.map(cluster => `
                <div class="cluster-card" id="cluster-${cluster.id}">
                    <div class="cluster-title">
                        <div class="cluster-badge" style="background: ${cluster.color};"></div>
                        ${cluster.name}
                    </div>
                    <div class="cluster-period">${cluster.period}</div>
                    <div class="cluster-keywords">
                        ${cluster.keywords.map(k => `<span class="keyword-tag">${k}</span>`).join('')}
                    </div>
                    <div class="cluster-events">
                        <strong>íŠ¹ì§•:</strong> ${cluster.characteristics}<br><br>
                        <strong>ì£¼ìš” ì‚¬ê±´ (${cluster.events.length}ê±´):</strong><br>
                        ${cluster.events.map(e => `â€¢ ${e.event}`).join('<br>')}
                    </div>
                </div>
            `).join('');
        }

        // Tab Navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.view-container').forEach(v => v.classList.remove('active'));
                
                this.classList.add('active');
                const viewId = this.dataset.view + '-view';
                document.getElementById(viewId).classList.add('active');
                
                if (this.dataset.view === 'flow') {
                    setTimeout(initFlowVisualization, 100);
                } else if (this.dataset.view === 'cluster') {
                    setTimeout(initCluster, 100);
                }
            });
        });

        // Filter event listeners
        document.getElementById('era-filter').addEventListener('change', initFlowVisualization);
        document.getElementById('role-filter').addEventListener('change', initFlowVisualization);
        document.getElementById('person-search').addEventListener('input', debounce(initFlowVisualization, 300));

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initTimeline();
        });
    </script>
</body>
</html>
